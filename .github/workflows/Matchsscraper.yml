name: Mise √† jour quotidienne des ligues

on:
  schedule:
    - cron: "0 0 * * *"  # Tous les jours √† 00h UTC
  workflow_dispatch:  # Permet un lancement manuel

jobs:
  update-json:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è‚É£ Cloner le d√©p√¥t
      - name: üì• Cloner le repo
        uses: actions/checkout@v3

      # 2Ô∏è‚É£ Installer Python
      - name: üêç Installer Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.11

      # 3Ô∏è‚É£ Installer les d√©pendances n√©cessaires
      - name: üì¶ Installer les d√©pendances
        run: pip install beautifulsoup4 requests

      # 4Ô∏è‚É£ Lancer le script de mise √† jour des ligues
      - name: üîÑ Lancer le script de mise √† jour
        run: python p_league.py  # Remplace par le nom r√©el de ton script si diff√©rent

      # 5Ô∏è‚É£ Commit et push uniquement si des fichiers ont chang√©
      - name: üÜô Commit et Push si changements
        run: |
          git config --global user.name "softbot"
          git config --global user.email "softbot@users.noreply.github.com"
          
          # Ajouter tous les fichiers JSON list√©s, y compris les 3 initiaux
          git add p_league.json \
                  laliga.json \
                  bundesliga.json \
                  Argentina_Primera_Nacional.json \
                  Austria_Bundesliga.json \
                  Belgium_Jupiler_Pro_League.json \
                  Brazil_Serie_A.json \
                  Brazil_Serie_B.json \
                  Chile_Primera_Division.json \
                  China_Super_League.json \
                  Colombia_Primera_A.json \
                  England_National_League.json \
                  France_Ligue_1.json \
                  Greece_Super_League_1.json \
                  Italy_Serie_A.json \
                  Japan_J1_League.json \
                  Mexico_Liga_MX.json \
                  Netherlands_Eredivisie.json \
                  Paraguay_Division_Profesional.json \
                  Peru_Primera_Division.json \
                  Portugal_Primeira_Liga.json \
                  Romania_Liga_I.json \
                  Russia_Premier_League.json \
                  Saudi_Arabia_Pro_League.json \
                  Sweden_Allsvenskan.json \
                  Switzerland_Super_League.json \
                  Turkey_Super_Lig.json \
                  USA_Major_League_Soccer.json \
                  Venezuela_Primera_Division.json
          
          # V√©rifier si quelque chose a chang√© avant de commit
          git diff --quiet && git diff --staged --quiet || git commit -m "üîÑ Mise √† jour automatique des matchs du $(date -u +'%Y-%m-%d')"
          
          # Push vers le d√©p√¥t
          git push